<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Books on Notebook</title><link>https://dpurge.github.io/docs/other/books/</link><description>Recent content in Books on Notebook</description><generator>Hugo</generator><language>en-us</language><atom:link href="https://dpurge.github.io/docs/other/books/index.xml" rel="self" type="application/rss+xml"/><item><title/><link>https://dpurge.github.io/docs/other/books/snippets/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dpurge.github.io/docs/other/books/snippets/</guid><description>&lt;h1 id="snippets"&gt;
 Snippets
 &lt;a class="anchor" href="#snippets"&gt;#&lt;/a&gt;
&lt;/h1&gt;
&lt;h2 id="export-pdf-to-png"&gt;
 Export PDF to PNG
 &lt;a class="anchor" href="#export-pdf-to-png"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Import-Module -Name D:\src\github.com\dpurge\jdp-psmodule\src\JdpBookbind
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Invoke-Book2Image -OutputDirectory img -InputFile book.pdf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;C:\jdp\pgm\poppler\bin\pdfimages.exe -png .\book.pdf img\page
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="convert-tiff-to-png"&gt;
 Convert TIFF to PNG
 &lt;a class="anchor" href="#convert-tiff-to-png"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$files = Get-ChildItem -Filter *.tif
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$i=&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;; $files | %{$i++; magick $_.name (&lt;span style="color:#e6db74"&gt;&amp;#34;page{0:d3}.png&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;-f&lt;/span&gt; $i)}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="convert-multipage-tiff-to-png"&gt;
 Convert multipage TIFF to PNG
 &lt;a class="anchor" href="#convert-multipage-tiff-to-png"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;magick book.tiff img/page-&lt;span style="color:#66d9ef"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;03d&lt;/span&gt;.png
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="merge-two-directories-with-images"&gt;
 Merge two directories with images
 &lt;a class="anchor" href="#merge-two-directories-with-images"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$a = Get-ChildItem -Filter *.png ./img1
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$b = Get-ChildItem -Filter *.png ./img2
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$imgs = $a + $b
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$i = &lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt; ($img &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; $imgs) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $f = &lt;span style="color:#e6db74"&gt;&amp;#34;./img/page-{0:d3}.png&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;-f&lt;/span&gt; $i
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Write-Host &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;$img&lt;span style="color:#e6db74"&gt; -&amp;gt; &lt;/span&gt;$f&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Move-Item -Path $img -Destination $f
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $i++
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="render-pdf-pages"&gt;
 Render PDF pages
 &lt;a class="anchor" href="#render-pdf-pages"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;.&lt;span style="color:#ae81ff"&gt;.350&lt;/span&gt; | %{D:\pgm\ImageMagick\convert.exe -density &lt;span style="color:#ae81ff"&gt;300&lt;/span&gt; book.pdf[$_] -quality &lt;span style="color:#ae81ff"&gt;100&lt;/span&gt; (&lt;span style="color:#e6db74"&gt;&amp;#34;./img/page-{0:d3}.tif&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;-f&lt;/span&gt; $_)}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;.&lt;span style="color:#ae81ff"&gt;.350&lt;/span&gt; | %{D:\pgm\ImageMagick\convert.exe -density &lt;span style="color:#ae81ff"&gt;300&lt;/span&gt; book.pdf[$_] -quality &lt;span style="color:#ae81ff"&gt;100&lt;/span&gt; -type Grayscale -filter Lanczos (&lt;span style="color:#e6db74"&gt;&amp;#34;./img/page-{0:d3}.png&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;-f&lt;/span&gt; $_)}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="convert-to-grayscale"&gt;
 Convert to grayscale
 &lt;a class="anchor" href="#convert-to-grayscale"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$files = Get-ChildItem -Filter *.png
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt;($file &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; $files) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $outfile = &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;${pwd}&lt;span style="color:#e6db74"&gt;\out\&lt;/span&gt;$($file.Name)&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Write-Host &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;$file&lt;span style="color:#e6db74"&gt; -&amp;gt; &lt;/span&gt;$outfile&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# D:\pgm\ImageMagick\convert.exe -grayscale Rec709Luminance $file $outfile&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; D:\pgm\ImageMagick\convert.exe -negate $file $outfile
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# D:\pgm\ImageMagick\convert.exe $file -depth 4 -colorspace gray -define png:color-type=0 -define png:bit-depth=4 $outfile&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="convert-flac-to-mp3"&gt;
 Convert FLAC to MP3
 &lt;a class="anchor" href="#convert-flac-to-mp3"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$files = Get-ChildItem -Filter *.flac
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt;($file &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; $files) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $outfile = ($file.Fullname &lt;span style="color:#f92672"&gt;-replace&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;.flac$&amp;#39;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#39;.mp3&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Write-Host &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;$file&lt;span style="color:#e6db74"&gt; -&amp;gt; &lt;/span&gt;$outfile&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; D:\pgm\ffmpeg\bin\ffmpeg.exe -i $file -ab 320k -map_metadata &lt;span style="color:#ae81ff"&gt;0&lt;/span&gt; -id3v2_version &lt;span style="color:#ae81ff"&gt;3&lt;/span&gt; $outfile
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="convert-wma-to-mp3"&gt;
 Convert WMA to MP3
 &lt;a class="anchor" href="#convert-wma-to-mp3"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$files = Get-ChildItem -Filter *.wma
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt;($file &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; $files) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $outfile = ($file.Fullname &lt;span style="color:#f92672"&gt;-replace&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;.wma$&amp;#39;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#39;.mp3&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Write-Host &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;$file&lt;span style="color:#e6db74"&gt; -&amp;gt; &lt;/span&gt;$outfile&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; D:\pgm\ffmpeg\bin\ffmpeg.exe -i $file -ab 192k $outfile
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="convert-webm-to-mp3"&gt;
 Convert WEBM to MP3
 &lt;a class="anchor" href="#convert-webm-to-mp3"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;D:\pgm\ffmpeg\bin\ffmpeg.exe -i nagranie.webm -vn -ab 128k -ar &lt;span style="color:#ae81ff"&gt;44100&lt;/span&gt; -y nagranie.mp3
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="download-from-youtube"&gt;
 Download from YouTube
 &lt;a class="anchor" href="#download-from-youtube"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;youtube-dl -x --audio-format mp3 &amp;lt;Video-URL&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;youtube-dl &lt;span style="color:#f92672"&gt;-f&lt;/span&gt; bestaudio[ext=m4a] --embed-thumbnail --add-metadata &amp;lt;Video-URL&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="convert-png-to-svg"&gt;
 Convert PNG to SVG
 &lt;a class="anchor" href="#convert-png-to-svg"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$files = Get-ChildItem -Filter *.png
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt;($pngfile &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; $files) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $bmpfile = ($pngfile.Fullname &lt;span style="color:#f92672"&gt;-replace&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;([^.]).png&amp;#39;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#39;.bmp&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $svgfile = ($pngfile.Fullname &lt;span style="color:#f92672"&gt;-replace&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;([^.]).png&amp;#39;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#39;.svg&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Write-Host &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;$pngfile&lt;span style="color:#e6db74"&gt; -&amp;gt; &lt;/span&gt;$bmpfile&lt;span style="color:#e6db74"&gt; -&amp;gt; &lt;/span&gt;$svgfile&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; D:\pgm\ImageMagick\convert.exe $pngfile $bmpfile
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; potrace.exe -s -a0 $bmpfile
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="print-scanned-book-for-binding"&gt;
 Print scanned book for binding
 &lt;a class="anchor" href="#print-scanned-book-for-binding"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$sheets = &lt;span style="color:#ae81ff"&gt;8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$pages = &lt;span style="color:#ae81ff"&gt;4&lt;/span&gt; * $sheets
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$files = Get-ChildItem -Filter *.png
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$blank = $files[&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$batches=&lt;span style="color:#66d9ef"&gt;for&lt;/span&gt;($i=&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;; $i &lt;span style="color:#f92672"&gt;-lt&lt;/span&gt; $files.length; $i+=$pages){ ,($files[$i..($i + $pages - &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;)])}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt; ($i &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;..($pages - $batches[&lt;span style="color:#ae81ff"&gt;-1&lt;/span&gt;].length)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $batches[&lt;span style="color:#ae81ff"&gt;-1&lt;/span&gt;] += $blank
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$batchnr = &lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt;($batch &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; $batches) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $batchnr += &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $outfile = &lt;span style="color:#e6db74"&gt;&amp;#34;../batch-{0:d2}.pdf&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;-f&lt;/span&gt; $batchnr
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $printBatch = @()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt; ($i &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;..($batch.length / &lt;span style="color:#ae81ff"&gt;4&lt;/span&gt; - &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $printBatch += $batch[($pages - &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt; - &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt; * $i)] &lt;span style="color:#75715e"&gt;# last page&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $printBatch += $batch[(&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt; * $i)] &lt;span style="color:#75715e"&gt;# first page&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $printBatch += $batch[(&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt; * $i + &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;)] &lt;span style="color:#75715e"&gt;# second page&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $printBatch += $batch[($pages - &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt; - &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt; * $i - &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;)] &lt;span style="color:#75715e"&gt;# last-but-one page&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Write-Host $outfile
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Write-Host $printBatch.basename
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; magick $printBatch $outfile
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="scale-pdf-page-for-printing"&gt;
 Scale PDF page for printing
 &lt;a class="anchor" href="#scale-pdf-page-for-printing"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cpdf -scale-page &lt;span style="color:#e6db74"&gt;&amp;#34;1.4 1.4&amp;#34;&lt;/span&gt; batch-&lt;span style="color:#ae81ff"&gt;01&lt;/span&gt;.pdf -o batch-&lt;span style="color:#ae81ff"&gt;01&lt;/span&gt;-scaled.pdf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="scale-pdf-to-fit-and-add-margin"&gt;
 Scale PDF to fit and add margin
 &lt;a class="anchor" href="#scale-pdf-to-fit-and-add-margin"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-pwsh" data-lang="pwsh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cpdf -scale-to-fit a4portrait -scale-to-fit-scale &lt;span style="color:#ae81ff"&gt;0.9&lt;/span&gt; book-&lt;span style="color:#ae81ff"&gt;01&lt;/span&gt;.pdf -o batch-&lt;span style="color:#ae81ff"&gt;01&lt;/span&gt;.pdf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>